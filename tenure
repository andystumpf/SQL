 SELECT YEAR,
       Week,
       avg(tenure) AS average_tenure
FROM
  (
SELECT DISTINCT caldate,
                DATEDIFF(month, start_date,end_date) AS tenure,
                TO_CHAR(caldate, 'IYYY') AS YEAR,
                date_part(week,caldate) AS Week 
FROM date_table dt
LEFT JOIN (
SELECT fullname,
       start_date,
       CASE
           WHEN end_date IS NULL THEN getdate()
           ELSE end_date
       END AS end_date
FROM roster)SR ON caldate BETWEEN start_date AND end_date
WHERE caldate >= '2015-01-01'
  AND caldate < getdate()
GROUP BY caldate,start_date,end_date)
GROUP BY YEAR,
         Week
ORDER BY YEAR,
         Week
